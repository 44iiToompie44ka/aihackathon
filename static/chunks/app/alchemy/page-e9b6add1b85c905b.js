(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{8837:function(e,t,l){Promise.resolve().then(l.bind(l,5123))},5123:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return k}});var s,r,a=l(3827),i=l(4090),n=l(503),d=l(8670),c=l(1450),o=l(3505),m=l(706);(s=r||(r={}))[s.Time=0]="Time",s[s.Name=1]="Name",s[s.Emoji=2]="Emoji";let u=e=>{let{sort:t,onClick:l}=e;return 0===t?(0,a.jsxs)("button",{onClick:l,className:"flex flex-1 border gap-2 justify-center items-center",children:[(0,a.jsx)(c.Z,{})," Сортировать по времени"]}):1===t?(0,a.jsxs)("button",{onClick:l,className:"flex flex-1 border gap-2 justify-center items-center",children:[(0,a.jsx)(o.Z,{})," Сортировать по имени"]}):2===t?(0,a.jsxs)("button",{onClick:l,className:"flex flex-1 border gap-2 justify-center items-center",children:[(0,a.jsx)(m.Z,{})," Сортировать по эмодзи"]}):void 0};var x=l(7135),f=l(5083),p=l(1216);let j=e=>{let{element:t}=e;return(0,a.jsxs)("div",{className:"flex gap-2 px-2 border rounded-xl h-fit w-fit",children:[(0,a.jsx)("div",{children:t.emoji}),(0,a.jsx)("div",{children:t.text})]})},h=e=>{let{element:t,isLoading:l}=e,{attributes:s,listeners:r,setNodeRef:i,transform:n}=(0,x.O1)({id:t.text,data:{element:t,type:"element"},disabled:l}),d={transform:p.ux.Translate.toString(n)};return(0,a.jsx)("div",{ref:i,style:d,className:"w-fit h-fit",...r,...s,children:(0,a.jsx)(j,{element:t})})},g=e=>{let{element:t,isLoading:l}=e,{attributes:s,listeners:r,setNodeRef:n,transform:d}=(0,x.O1)({id:t.id,data:{element:t,type:"placed-element"},disabled:l}),{isOver:c,setNodeRef:o}=(0,x.Zj)({id:t.id,data:{element:t,type:"placed-element"},disabled:l}),m=(0,i.useMemo)(()=>({transform:p.ux.Translate.toString(d),top:t.y,left:t.x,border:c?"2px solid green":"none"}),[t.x,t.y,c,d]);return(0,a.jsx)("div",{ref:n,className:"absolute w-fit h-fit",style:m,...r,...s,children:(0,a.jsxs)("div",{ref:o,children:[t.isLoading&&(0,a.jsxs)("div",{className:"flex gap-2 px-2 border rounded-xl h-fit w-fit",children:[(0,a.jsx)("div",{children:(0,a.jsx)(f.Z,{className:"animate-spin inline-block"})}),(0,a.jsx)("div",{children:"combining"})]}),!t.isLoading&&(0,a.jsx)(j,{element:t})]})})},v=e=>{let{elements:t,isLoading:l}=e,[s,c]=(0,i.useState)(r.Time),[o,m]=(0,i.useState)(!1),[f,p]=(0,i.useState)(""),j=(0,i.useMemo)(()=>{let e=[...t];switch(s){case r.Time:return e;case r.Name:return e.sort((e,t)=>e.text.localeCompare(t.text));case r.Emoji:return e.sort((e,t)=>e.emoji.localeCompare(t.emoji))}},[t,s]),{setNodeRef:g}=(0,x.Zj)({id:"sidebar-area",data:{type:"sidebar"},disabled:l});return(0,a.jsxs)("div",{className:"col-span-3 border-l h-screen flex flex-col",ref:g,children:[(0,a.jsx)("div",{className:"flex flex-1 justify-start items-start overflow-y-scroll overflow-x-hidden",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2 p-2",children:j.filter(e=>!o||o&&e.discovered).filter(e=>!f||e.text.includes(f)||e.emoji.includes(f)).map(e=>(0,a.jsx)(h,{element:e,isLoading:l},e.text))})}),(0,a.jsxs)("div",{className:"h-22 border-t flex-shrink-0 flex-col",children:[(0,a.jsxs)("div",{className:"flex h-10",children:[!o&&(0,a.jsxs)("button",{className:"flex flex-1 border gap-2 justify-center items-center",onClick:()=>m(!0),children:[(0,a.jsx)(n.Z,{})," Discoveries"]}),o&&(0,a.jsxs)("button",{className:"flex flex-1 border gap-2 justify-center items-center bg-gray-500",onClick:()=>m(!1),children:[(0,a.jsx)(n.Z,{})," Разработки"]}),(0,a.jsx)(u,{sort:s,onClick:()=>{switch(s){case r.Time:c(r.Name);break;case r.Name:c(r.Emoji);break;case r.Emoji:c(r.Time)}}})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2",children:[(0,a.jsx)(d.Z,{})," ",(0,a.jsx)("input",{value:f,onChange:e=>p(e.target.value),className:"flex px-2 rounded-md w-full text-gray-600",placeholder:"Search..."})]})]})]})},y=[{text:"Огонь",emoji:"\uD83D\uDD25",discovered:!1},{text:"Вода",emoji:"\uD83D\uDCA7",discovered:!1},{text:"Воздух",emoji:"\uD83D\uDCA8",discovered:!1},{text:"Земля",emoji:"\uD83C\uDF0D",discovered:!1}];var b=l(1231),N=l(7908),w=l(6806),S=l(3348);let E=e=>{let{placedElements:t,setPlacedElements:l,setElements:s,isLoading:r}=e,i=()=>{l([])},{setNodeRef:n}=(0,x.Zj)({id:"playground-area",data:{type:"playground"},disabled:r});return(0,a.jsxs)("div",{className:"col-span-9 h-full w-full relative",ref:n,children:[t.map((e,t)=>(0,a.jsx)(g,{element:e,isLoading:r},t)),(0,a.jsx)("div",{className:"absolute top-0 right-0 p-4 cursor-pointer hover:text-red-400",onClick:i,children:(0,a.jsx)(w.Z,{})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 p-4 cursor-pointer hover:text-red-400",onClick:()=>{window.confirm("Вы уверены, что хотите обнулить все разработки?")&&(i(),s(y))},children:(0,a.jsx)(S.Z,{})})]})};function k(){let[e,t]=(0,i.useState)([]),[l,s]=(0,i.useState)([]),[r,n]=(0,i.useState)(null),[d,c]=(0,i.useState)(null),[o,m]=(0,i.useState)({x:0,y:0});(0,i.useEffect)(()=>{let e=e=>{m({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}},[]),(0,i.useEffect)(()=>{let e=localStorage.getItem("elements");if(!e){t(y);return}let l=JSON.parse(e);if(0===l.length){t(y);return}t(l)},[]),(0,i.useEffect)(()=>{0!==e.length&&localStorage.setItem("elements",JSON.stringify(e))},[e]);let u=(l,r)=>{"id"in r?s(e=>e.filter(e=>e.id!==r.id).map(e=>e.id===l.id?{...e,isLoading:!0}:e)):s(e=>e.map(e=>e.id===l.id?{...e,isLoading:!0}:e)),N.Z.get("/api/combine",{params:{word1:l.text,word2:r.text}}).then(r=>{let{data:a}=r;s(e=>e.map(e=>e.id===l.id?{...a.element,id:(0,b.Z)(),x:e.x,y:e.y,isLoading:!1}:e)),e.every(e=>e.text!==a.element.text)&&t(e=>[...e,a.element])}).catch(e=>{window.alert("Something when wrong! Failed to combine elements"+e.toString()),s(e=>e.map(e=>e.id===l.id?{...e,isLoading:!1}:e))})},f=(0,i.useMemo)(()=>l.some(e=>e.isLoading),[l]);return(0,a.jsxs)(x.LB,{onDragStart:e=>{let{active:t}=e;"element"===t.data.current.type?n(e.active.data.current.element):"placed-element"===t.data.current.type&&c(e.active.data.current.element)},onDragEnd:e=>{let{active:t,over:r}=e;if(console.log("active",t),console.log("over",r),"placed-element"===t.data.current.type&&r&&"sidebar"===r.data.current.type){let e=t.data.current.element;s(l.filter(t=>t.id!==e.id))}else if("placed-element"===t.data.current.type&&r&&"placed-element"===r.data.current.type)u(r.data.current.element,t.data.current.element);else if("placed-element"===t.data.current.type){let r=t.data.current.element;s(l.map(t=>t.id===r.id?{...r,x:r.x+e.delta.x,y:r.y+e.delta.y}:t))}if("element"===t.data.current.type&&r&&"playground"===r.data.current.type){let e={...t.data.current.element,id:(0,b.Z)(),x:o.x,y:o.y};s(t=>[...t,e])}else"element"===t.data.current.type&&r&&"placed-element"===r.data.current.type&&u(r.data.current.element,t.data.current.element);n(null),c(null)},children:[(0,a.jsx)("main",{className:"flex h-screen flex-col",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 h-full",children:[(0,a.jsx)(E,{setElements:t,setPlacedElements:s,placedElements:l,isLoading:f}),(0,a.jsx)(v,{elements:e,isLoading:f})]})}),(0,a.jsxs)(x.y9,{dropAnimation:null,children:[r&&(0,a.jsx)(j,{element:r}),d&&(0,a.jsx)(j,{element:d})]})]})}l(3980)},3980:function(){}},function(e){e.O(0,[937,971,69,744],function(){return e(e.s=8837)}),_N_E=e.O()}]);